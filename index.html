<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Deputy Challenge</title>
</head>
<body>
<!-- Scripts -->
<script type="text/javascript" src="scripts/roster.js"></script>
<script type="text/javascript" src="scripts/users.js"></script>
<script type="text/javascript" src="scripts/helpers.js"></script>
<script>
  // Variables used for simulations
  let rosterId = 1;
  let employeeId = 1;
  let departmentId = 1;

  let firstShiftDateTimeStart = 1508450400;
  let firstShiftDateTimeEnd   = 1508479200;
  // Convert the unix into milliseconds
  firstShiftDateTimeStart = dateConvertHelper(firstShiftDateTimeStart);
  firstShiftDateTimeEnd = dateConvertHelper(firstShiftDateTimeEnd);

  const objRoster1 = new Roster(rosterId,employeeId,departmentId,firstShiftDateTimeStart,firstShiftDateTimeEnd);

  // Add one day to simulate new shifts
  let shiftDateTimeStart = new Date(firstShiftDateTimeStart);
  let oneDayAfterStart = (shiftDateTimeStart.getDate()+1);
  shiftDateTimeStart.setDate(oneDayAfterStart);
  let shiftDateTimeEnd = new Date(firstShiftDateTimeEnd);
  shiftDateTimeEnd = shiftDateTimeEnd.setDate(shiftDateTimeEnd.getDate()+1);

  // Create new shift
  rosterId++;
  const objRoster2 = new Roster(rosterId,employeeId,departmentId,shiftDateTimeStart,shiftDateTimeEnd);

  printData('Simulate scenario 1');
  simulateShifts(objRoster1, objRoster2);

  // Simulate same days - times
  printData('Simulate scenario 2 - Same dates');
  rosterId++;
  const objRoster3 = new Roster(rosterId,employeeId,departmentId,firstShiftDateTimeStart,firstShiftDateTimeEnd);
  simulateShifts(objRoster1, objRoster3);

  // Simulate 3  dates before current shift
  printNewLine();
  printData('Simulate scenario 3 - dates before current shift');
  rosterId++;
  // Subtract one day to simulate new shifts
  let shiftDateTimeStartNew = new Date(firstShiftDateTimeStart);
  shiftDateTimeStartNew = shiftDateTimeStartNew.setDate(shiftDateTimeStartNew.getDate()-1);
  shiftDateTimeEnd = new Date(firstShiftDateTimeEnd);
  shiftDateTimeEnd = shiftDateTimeEnd.setDate(shiftDateTimeEnd.getDate()-1);

  const objRoster4 = new Roster(rosterId,employeeId,departmentId,shiftDateTimeStartNew,shiftDateTimeEnd);
  simulateShifts(objRoster1, objRoster4);

    // Question 2
    printNewLine();
    printData('Question 2');
    printNewLine();

    // Arrays of roles information
    const ids = [1,2,3,4];
    const rolesTitles = ['System Administrator', 'Location Manager', 'Supervisor', 'Employee'];
    const parentIds = [0,1,2,3];

    // Instantiate roles objects based on the information above
    let arrayOfRoles = [];
    for (let i in ids){
      let role = new Role(ids[i], rolesTitles[i], parentIds[i]);
      arrayOfRoles.push(role)
    }

    // Array of users and roles
    const names = ['Adam Admin', 'Emily Employee', 'Sam Supervisor', 'Mary Manager'];
    const roleIds = [1,4,3,2];

    // Instantiate users objects based on the information above
    let arrayOfUsers = [];
    for (let i in ids){
        let user = new User(ids[i], names[i], roleIds[i]);
        arrayOfUsers.push(user)
    }

    // Create an array of objects with current users and his/her subordinates
    let allUsersData = [];
    for(const user in arrayOfUsers){
      let userObjects = {};
      userObjects.subordinates = {};
      // Get subordinates of the current user
      let subordinates = arrayOfUsers[user].findSubordinates(arrayOfUsers,arrayOfRoles);
      // if there is subordinate then push into the array
      if(subordinates){
        userObjects.currentUser = arrayOfUsers[user];
        userObjects.subordinates = subordinates
      }
      allUsersData.push(userObjects)
    }
    printData(allUsersData)

</script>
</body>
</html>